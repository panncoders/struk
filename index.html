<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Struk Indomaret + Biaya</title>
<style>
body{background:#eee;font-family:monospace}
#receipt{
  width:58mm;
  background:#fff;
  padding:8px;
  margin:20px auto;
  font-size:12px;
}
.center{text-align:center}
.row{display:flex;justify-content:space-between}
.line{border-top:1px dashed #000;margin:6px 0}
.big{font-weight:bold;font-size:14px}
@media print{
  body *{visibility:hidden}
  #receipt,#receipt *{visibility:visible}
  #receipt{position:absolute;top:0;left:0}
}
</style>
</head>
<body>

<div id="receipt">
  <div class="center big">INDOMARET</div>
  <div class="center">PT. Indomarco Prismatama</div>
  <div class="center">STORE NO. 12345</div>
  <div class="center">JL. ONLINE NO. 1</div>

  <div class="line"></div>

  <div>No Struk : <span id="noStruk"></span></div>
  <div>Tgl      : <span id="tgl"></span></div>
  <div>Kasir    : <span id="kasir"></span></div>
  <div>Buyer    : <span id="buyer"></span></div>

  <div class="line"></div>

  <div id="items"></div>

  <div class="line"></div>

  <div class="row"><span>SUB TOTAL</span><span id="subTotal"></span></div>
  <div class="row"><span>DISKON</span><span id="diskon"></span></div>
  <div class="row"><span>BIAYA ADMIN</span><span id="admin"></span></div>
  <div class="row"><span>PAJAK</span><span id="pajak"></span></div>

  <div class="line"></div>

  <div class="row big"><span>GRAND TOTAL</span><span id="grand"></span></div>
  <div class="row"><span>TUNAI</span><span id="tunai"></span></div>
  <div class="row"><span>KEMBALI</span><span id="kembali"></span></div>

  <div class="line"></div>

  <div class="center">
    TERIMA KASIH<br>
    SELAMAT BELANJA KEMBALI
  </div>

  <div class="line"></div>

  <div class="center">
    <svg id="barcode"></svg>
  </div>
</div>

<button onclick="window.print()" style="width:58mm;margin:auto;display:block">
  üñ®Ô∏è CETAK STRUK
</button>

<script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.6/dist/JsBarcode.all.min.js"></script>
<script>
// =================== DATA ===================
const ITEMS = [
  {name:"Script Seller", qty:1, price:25000},
  {name:"Murid Nokos", qty:2, price:10000}
];

const BUYER_NAME = "AKHMAD";
const CASHIERS = ["ANI","BUDI","SITI","RINA"];
const kasir = CASHIERS[Math.floor(Math.random()*CASHIERS.length)];

// ===== BIAYA =====
const DISKON = 5000;        // potongan
const BIAYA_ADMIN = 2000;  // admin
const PAJAK_PERSEN = 5;    // %

const KEY="receipt_no";
let no=parseInt(localStorage.getItem(KEY)||"0")+1;
localStorage.setItem(KEY,no);

// =================== HEADER ===================
document.getElementById("noStruk").innerText=String(no).padStart(6,"0");
document.getElementById("kasir").innerText=kasir;
document.getElementById("buyer").innerText=BUYER_NAME;

const now=new Date();
document.getElementById("tgl").innerText=
  now.toLocaleDateString("id-ID")+" "+now.toLocaleTimeString("id-ID");

// =================== ITEMS ===================
let subTotal=0;
const itemsEl=document.getElementById("items");

ITEMS.forEach(i=>{
  const sub=i.qty*i.price;
  subTotal+=sub;
  itemsEl.innerHTML+=`
    <div>${i.name}</div>
    <div class="row">
      <span>${i.qty} x ${rupiah(i.price)}</span>
      <span>${rupiah(sub)}</span>
    </div>
  `;
});

// =================== HITUNGAN ===================
const pajak = Math.round(subTotal * PAJAK_PERSEN / 100);
const grandTotal = subTotal - DISKON + BIAYA_ADMIN + pajak;

// =================== RENDER ===================
document.getElementById("subTotal").innerText=rupiah(subTotal);
document.getElementById("diskon").innerText="-"+rupiah(DISKON);
document.getElementById("admin").innerText=rupiah(BIAYA_ADMIN);
document.getElementById("pajak").innerText=rupiah(pajak);
document.getElementById("grand").innerText=rupiah(grandTotal);
document.getElementById("tunai").innerText=rupiah(grandTotal);
document.getElementById("kembali").innerText=rupiah(0);

// =================== BARCODE ===================
JsBarcode("#barcode",
  String(no).padStart(6,"0"),
  {format:"CODE128",width:2,height:40,displayValue:false}
);

// =================== UTIL ===================
function rupiah(n){
  return "Rp"+n.toLocaleString("id-ID");
}
</script>

</body>
</html>
